# Карта депо + распознавание поездов

Проект: интерактивная карта (Яндекс.Карты) и бэкенд распознавания поездов по камерам/скриншотам. Карта показывает фигуры депо и поезда (вручную или по WebSocket от `camall_screen_capture.py`).

## Структура

- **Корень** — карта для GitHub Pages: `index.html`, `train.png`.
- **demo-point-layer/** — исходники карты (дублируют корень).
- **gpu+out/** — Python: распознавание, камеры, WebSocket на порт 8765.
- **memory-bank/** — техописание стека.

## Как открыть карту по ссылке (GitHub Pages)

1. Создайте репозиторий на GitHub, залейте этот проект.
2. **Settings → Pages** → Source: **Deploy from a branch** → Branch: `main`, Folder: **/ (root)** → Save.
3. Через пару минут карта будет доступна по адресу:  
   `https://<ваш-логин>.github.io/<имя-репо>/`
4. **Яндекс API:** в [Кабинете разработчика](https://developer.tech.yandex.ru/) в настройках ключа добавьте в «Разрешить запросы с» домен:  
   `https://<ваш-логин>.github.io`  
   (или `*.github.io`), иначе карта на GitHub Pages может не загружаться.

На GitHub Pages **WebSocket к localhost:8765 не работает** — это нормально. Он нужен только при локальном запуске распознавания. Карта при этом работает: ручное добавление прямоугольников, координаты, масштаб.

## Локальный запуск (карта + распознавание)

1. **Карта:** откройте `index.html` в браузере или запустите из папки корня/`demo-point-layer`:  
   `npx serve .`
2. **Распознавание (опционально):** в `gpu+out/` создайте `config_screen_capture.json` (скопируйте из `config_screen_capture.example.json` и заполните, включая БД). Запустите:  
   `python camall_screen_capture.py`  
   Карта будет получать события поездов по WebSocket на порт 8765.

Конфиги `config_screen_capture.json` и `config_cams.json` содержат пароли и **не попадают в репозиторий** (см. `.gitignore`). Используйте примеры `*.example.json` для настройки у себя.
